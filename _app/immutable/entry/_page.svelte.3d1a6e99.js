import{S as Pe,i as Re,s as Ae,k as T,l as O,m as S,h as b,n as M,b as D,H as te,J as De,q as B,a as H,r as C,c as q,K as Se,G as I,L as fe,M as L,N as ne,O as re,u as J,e as X,P as je,p as K}from"../chunks/index.8b214ad8.js";var G={};G.Mapping=class{constructor(l,n,e,t,s){this.pairs=this.pairs.bind(this),this.alignment=this.alignment.bind(this),this.a=l,this.b=n,this.distance=e,this.track=t,this.backtrackFn=s,this.pairCache=null}pairs(){return this.pairCache==null&&(this.pairCache=this.backtrackFn(this.a,this.b,this.track)),this.pairCache}alignment(){var l,n,e,t,s,r,a;for(r=this.pairs(),l=[],n=[],a=r.reverse(),e=0,t=a.length;e<t;e++)s=a[e],l.push(s[0]),n.push(s[1]);return{alignmentA:l,alignmentB:n}}};G.zero=function(i,l){var n,e,t,s,r,a,h,o;for(h=new Array(i),n=t=0,r=i;t<r;n=t+=1)for(o=h[n]=new Array(l),e=s=0,a=l;s<a;e=s+=1)o[e]=0;return h};G.trackedMin=function(i,l,n){var e;return e={value:i,index:0},l<e.value&&(e.value=l,e.index=1),n<e.value&&(e.value=n,e.index=2),e};var we,Ee,ye,ze,Ie,W;({Mapping:we,zero:W,trackedMin:Ie}=G);Ee=function(i,l,n){var e,t,s,r,a,h,o,d,_,w,E;for(w=[],E=[],w.push([void 0,i]);w.length>0;)for([r,o]=w.pop(),t=l(o),s=(d=t!=null?t[0]:void 0)!=null?d:null,E.push([r,o,s]),_=t??[],r=a=0,h=_.length;a<h;r=++a)e=_[r],w.push([r,e]);for(;E.length>0;)[r,o,s]=E.pop(),n(r,o,s)};ye=function(i,l,n,e,t,s){var r,a,h,o,d,_,w,E,p,m,v,k,c,y,f,P;for(E=function(R){var u;return u={nodes:[],llds:[],keyroots:[]},Ee(R,n,function(g,F,U){var j,N,A;A=u.nodes.length,u.nodes.push(F),U==null?N=A:(j=u.nodes.indexOf(U),N=u.llds[j]),u.llds.push(N),g!==0&&u.keyroots.push(A)}),u},f=function(R,u){var g,F,U,j,N,A,z,V,Q,Y,Z,$,x,ee,ie,oe,le,ae,ce,he,ue;for(F=v.llds,N=k.llds,U=v.nodes,A=k.nodes,z=F[R]-1,V=N[u]-1,Z=R-F[R]+2,x=u-N[u]+2,g=Q=1,ae=Z;Q<ae;g=Q+=1)r[g][0]=r[g-1][0]+t(U[g+z]);for(j=Y=1,ce=x;Y<ce;j=Y+=1)r[0][j]=r[0][j-1]+e(A[j+V]);for(g=ee=1,he=Z;ee<he;g=ee+=1)for(j=le=1,ue=x;le<ue;j=le+=1)F[R]===F[g+z]&&N[u]===N[j+V]?($=Ie(r[g-1][j]+t(U[g+z]),r[g][j-1]+e(A[j+V]),r[g-1][j-1]+s(U[g+z],A[j+V])),P[g+z][j+V]=$.index,c[g+z][j+V]=r[g][j]=$.value):(ie=F[g+z]-1-z,oe=N[j+V]-1-V,r[g][j]=Math.min(r[g-1][j]+t(U[g+z]),r[g][j-1]+e(A[j+V]),r[ie][oe]+c[g+z][j+V]))},v=E(i),k=E(l),P=W(v.nodes.length,k.nodes.length),c=W(v.nodes.length,k.nodes.length),r=W(v.nodes.length+1,k.nodes.length+1),p=v.keyroots,o=0,_=p.length;o<_;o++)for(a=p[o],m=k.keyroots,d=0,w=m.length;d<w;d++)h=m[d],f(a,h);return y=c[v.nodes.length-1][k.nodes.length-1],new we(v,k,y,P,ze)};ze=function(i,l,n){var e,t,s;for(s=[],e=i.nodes.length-1,t=l.nodes.length-1;e>=0&&t>=0;)switch(n[e][t]){case 0:s.push([i.nodes[e],null]),--e;break;case 1:s.push([null,l.nodes[t]]),--t;break;case 2:s.push([i.nodes[e],l.nodes[t]]),--e,--t;break;default:throw new Error(`Invalid operation ${n[e][t]} at (${e}, ${t})`)}if(e===-1&&t!==-1)for(;t>=0;)s.push([null,l.nodes[t]]),--t;if(e!==-1&&t===-1)for(;e>=0;)s.push([i.nodes[e],null]),--e;return s};var Fe=ye,Me,Ne,Te,Oe,se;({Mapping:Me,zero:se,trackedMin:Oe}=G);Ne=function(i,l,n,e,t){var s,r,a,h,o,d,_,w,E,p,m,v,k,c,y,f,P,R;for(s=i,a=l,R=se(s.length+1,a.length+1),o=se(s.length+1,a.length+1),_=E=1,c=s.length;E<=c;_=E+=1)o[_][0]=_;for(w=p=1,y=a.length;p<=y;w=p+=1)o[0][w]=w;for(_=m=1,f=s.length;m<=f;_=m+=1)for(w=k=1,P=a.length;k<=P;w=k+=1)r=s[_-1],h=a[w-1],v=Oe(o[_-1][w]+e(r),o[_][w-1]+n(h),o[_-1][w-1]+t(r,h)),R[_][w]=v.index,o[_][w]=v.value;return d=o[s.length][a.length],new Me(s,a,d,R,Te)};Te=function(i,l,n){var e,t,s;for(e=i.length,t=l.length,s=[];e>0&&t>0;)switch(n[e][t]){case 0:s.push([i[e-1],null]),--e;break;case 1:s.push([null,l[t-1]]),--t;break;case 2:s.push([i[e-1],l[t-1]]),--e,--t;break;default:throw new Error(`Invalid operation ${n[e][t]} at (${e}, ${t})`)}if(e===0&&t!==0)for(;t>0;)s.push([null,l[t-1]]),--t;if(e!==0&&t===0)for(;e>0;)s.push([i[e-1],null]),--e;return s};var Ue=Ne,Ve={ted:Fe,levenshtein:Ue};function _e(i,l,n){const e=i.slice();return e[20]=l[n],e}function pe(i,l,n){const e=i.slice();return e[23]=l[n],e}function de(i,l,n){const e=i.slice();return e[26]=l[n],e}function Be(i){let l,n,e,t,s,r,a,h,o,d,_,w,E=i[0],p=[];for(let c=0;c<E.length;c+=1)p[c]=ve(de(i,E,c));let m=i[6].lines,v=[];for(let c=0;c<m.length;c+=1)v[c]=me(_e(i,m,c));let k=i[6].lines[i[2]-1].character==i[1]&&be(i);return{c(){l=T("div"),n=T("input"),e=B(` Fast forward
			
			`),t=T("button"),s=B("Pick line"),r=H(),a=T("select");for(let c=0;c<p.length;c+=1)p[c].c();h=H(),o=T("div");for(let c=0;c<v.length;c+=1)v[c].c();d=H(),k&&k.c(),this.h()},l(c){l=O(c,"DIV",{id:!0});var y=S(l);n=O(y,"INPUT",{type:!0}),e=C(y,` Fast forward
			
			`),t=O(y,"BUTTON",{class:!0});var f=S(t);s=C(f,"Pick line"),f.forEach(b),r=q(y),a=O(y,"SELECT",{class:!0});var P=S(a);for(let u=0;u<p.length;u+=1)p[u].l(P);P.forEach(b),y.forEach(b),h=q(c),o=O(c,"DIV",{class:!0});var R=S(o);for(let u=0;u<v.length;u+=1)v[u].l(R);d=q(R),k&&k.l(R),R.forEach(b),this.h()},h(){M(n,"type","checkbox"),M(t,"class","svelte-vj1jsz"),M(a,"class","svelte-vj1jsz"),i[1]===void 0&&Se(()=>i[15].call(a)),M(l,"id","controls"),M(o,"class","lines svelte-vj1jsz")},m(c,y){D(c,l,y),I(l,n),n.checked=i[4],I(l,e),I(l,t),I(t,s),I(l,r),I(l,a);for(let f=0;f<p.length;f+=1)p[f].m(a,null);fe(a,i[1]),D(c,h,y),D(c,o,y);for(let f=0;f<v.length;f+=1)v[f].m(o,null);I(o,d),k&&k.m(o,null),_||(w=[L(n,"change",i[13]),L(t,"click",i[14]),L(a,"change",i[15]),L(a,"change",i[11])],_=!0)},p(c,y){if(y&16&&(n.checked=c[4]),y&1){E=c[0];let f;for(f=0;f<E.length;f+=1){const P=de(c,E,f);p[f]?p[f].p(P,y):(p[f]=ve(P),p[f].c(),p[f].m(a,null))}for(;f<p.length;f+=1)p[f].d(1);p.length=E.length}if(y&3&&fe(a,c[1]),y&1262){m=c[6].lines;let f;for(f=0;f<m.length;f+=1){const P=_e(c,m,f);v[f]?v[f].p(P,y):(v[f]=me(P),v[f].c(),v[f].m(o,d))}for(;f<v.length;f+=1)v[f].d(1);v.length=m.length}c[6].lines[c[2]-1].character==c[1]?k?k.p(c,y):(k=be(c),k.c(),k.m(o,null)):k&&(k.d(1),k=null)},d(c){c&&b(l),ne(p,c),c&&b(h),c&&b(o),ne(v,c),k&&k.d(),_=!1,re(w)}}}function Ce(i){let l,n,e,t,s,r,a,h;return{c(){l=T("h1"),n=B("No script uploaded"),e=B(`
		Upload a script in .json format to get started.
		`),t=T("br"),s=H(),r=T("input"),this.h()},l(o){l=O(o,"H1",{class:!0});var d=S(l);n=C(d,"No script uploaded"),d.forEach(b),e=C(o,`
		Upload a script in .json format to get started.
		`),t=O(o,"BR",{}),s=q(o),r=O(o,"INPUT",{type:!0,accept:!0}),this.h()},h(){M(l,"class","svelte-vj1jsz"),M(r,"type","file"),M(r,"accept",".json")},m(o,d){D(o,l,d),I(l,n),D(o,e,d),D(o,t,d),D(o,s,d),D(o,r,d),a||(h=L(r,"change",i[8]),a=!0)},p:te,d(o){o&&b(l),o&&b(e),o&&b(t),o&&b(s),o&&b(r),a=!1,h()}}}function ve(i){let l,n=i[26]+"",e,t;return{c(){l=T("option"),e=B(n),this.h()},l(s){l=O(s,"OPTION",{});var r=S(l);e=C(r,n),r.forEach(b),this.h()},h(){l.__value=t=i[26],l.value=l.__value},m(s,r){D(s,l,r),I(l,e)},p(s,r){r&1&&n!==(n=s[26]+"")&&J(e,n),r&1&&t!==(t=s[26])&&(l.__value=t,l.value=l.__value)},d(s){s&&b(l)}}}function ge(i){let l,n,e=i[20].character+"",t,s,r,a,h;function o(p,m){return m&224&&(r=null),r==null&&(r=!!(!p[5]&&p[7].has(p[20].line_no))),r?He:Le}let d=o(i,-1),_=d(i);function w(){return i[16](i[20])}function E(...p){return i[17](i[20],...p)}return{c(){l=T("div"),n=T("h4"),t=B(e),s=H(),_.c(),this.h()},l(p){l=O(p,"DIV",{class:!0});var m=S(l);n=O(m,"H4",{class:!0});var v=S(n);t=C(v,e),v.forEach(b),s=q(m),_.l(m),m.forEach(b),this.h()},h(){M(n,"class","svelte-vj1jsz"),M(l,"class","line svelte-vj1jsz")},m(p,m){D(p,l,m),I(l,n),I(n,t),I(l,s),_.m(l,null),a||(h=[je(i[12].call(null,l)),L(l,"click",w),L(l,"keypress",E)],a=!0)},p(p,m){i=p,m&64&&e!==(e=i[20].character+"")&&J(t,e),d===(d=o(i,m))&&_?_.p(i,m):(_.d(1),_=d(i),_&&(_.c(),_.m(l,null)))},d(p){p&&b(l),_.d(),a=!1,re(h)}}}function Le(i){let l=i[20].line+"",n;return{c(){n=B(l)},l(e){n=C(e,l)},m(e,t){D(e,n,t)},p(e,t){t&64&&l!==(l=e[20].line+"")&&J(n,l)},d(e){e&&b(n)}}}function He(i){let l,n=i[7].get(i[20].line_no)||[{correct:"ERROR",color:"red"}],e=[];for(let t=0;t<n.length;t+=1)e[t]=ke(pe(i,n,t));return{c(){for(let t=0;t<e.length;t+=1)e[t].c();l=X()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);l=X()},m(t,s){for(let r=0;r<e.length;r+=1)e[r].m(t,s);D(t,l,s)},p(t,s){if(s&192){n=t[7].get(t[20].line_no)||[{correct:"ERROR",color:"red"}];let r;for(r=0;r<n.length;r+=1){const a=pe(t,n,r);e[r]?e[r].p(a,s):(e[r]=ke(a),e[r].c(),e[r].m(l.parentNode,l))}for(;r<e.length;r+=1)e[r].d(1);e.length=n.length}},d(t){ne(e,t),t&&b(l)}}}function ke(i){let l,n=i[23].correct+"",e,t,s=i[23].incorrect+"",r;return{c(){l=T("span"),e=B(n),t=T("span"),r=B(s),this.h()},l(a){l=O(a,"SPAN",{style:!0,class:!0});var h=S(l);e=C(h,n),t=O(h,"SPAN",{style:!0,class:!0});var o=S(t);r=C(o,s),o.forEach(b),h.forEach(b),this.h()},h(){K(t,"text-decoration","line-through"),K(t,"font-size","8pt"),M(t,"class","svelte-vj1jsz"),K(l,"color",i[23].color),M(l,"class","svelte-vj1jsz")},m(a,h){D(a,l,h),I(l,e),I(l,t),I(t,r)},p(a,h){h&192&&n!==(n=a[23].correct+"")&&J(e,n),h&192&&s!==(s=a[23].incorrect+"")&&J(r,s),h&192&&K(l,"color",a[23].color)},d(a){a&&b(l)}}}function me(i){let l,n=(i[5]||i[20].line_no>=i[3]&&i[20].line_no<=i[2]&&!(i[20].line_no==i[2]&&i[20].character==i[1]))&&ge(i);return{c(){n&&n.c(),l=X()},l(e){n&&n.l(e),l=X()},m(e,t){n&&n.m(e,t),D(e,l,t)},p(e,t){e[5]||e[20].line_no>=e[3]&&e[20].line_no<=e[2]&&!(e[20].line_no==e[2]&&e[20].character==e[1])?n?n.p(e,t):(n=ge(e),n.c(),n.m(l.parentNode,l)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&b(l)}}}function be(i){let l,n,e,t,s,r,a;return{c(){l=T("div"),n=T("h4"),e=B(i[1]),t=H(),s=T("textarea"),this.h()},l(h){l=O(h,"DIV",{class:!0});var o=S(l);n=O(o,"H4",{class:!0});var d=S(n);e=C(d,i[1]),d.forEach(b),t=q(o),s=O(o,"TEXTAREA",{id:!0,class:!0}),S(s).forEach(b),o.forEach(b),this.h()},h(){M(n,"class","svelte-vj1jsz"),M(s,"id","user_input"),M(s,"class","svelte-vj1jsz"),M(l,"class","line svelte-vj1jsz")},m(h,o){D(h,l,o),I(l,n),I(n,e),I(l,t),I(l,s),r||(a=[L(s,"beforeinput",i[9]),je(i[12].call(null,s))],r=!0)},p(h,o){o&2&&J(e,h[1])},d(h){h&&b(l),r=!1,re(a)}}}function qe(i){let l;function n(s,r){return s[6]==null?Ce:Be}let e=n(i),t=e(i);return{c(){l=T("div"),t.c(),this.h()},l(s){l=O(s,"DIV",{id:!0,class:!0});var r=S(l);t.l(r),r.forEach(b),this.h()},h(){M(l,"id","container"),M(l,"class","svelte-vj1jsz")},m(s,r){D(s,l,r),t.m(l,null)},p(s,[r]){e===(e=n(s))&&t?t.p(s,r):(t.d(1),t=e(s),t&&(t.c(),t.m(l,null)))},i:te,o:te,d(s){s&&b(l),t.d()}}}function Je(i){let l="",n="",e="";const t=[];for(const s of i.pairs().reverse()){const[r,a]=s,h=r===a?"green":"red";h!=l&&(n!=""||e!="")&&(t.push({correct:n,incorrect:e,color:l}),n="",e=""),l=h,r!=null&&(n+=r),a!=null&&r!=a&&(e+=a)}return(n!=""||e!="")&&t.push({correct:n,incorrect:e,color:l}),t}function Ge(i,l,n){let e=[],t="",s=1,r=1,a=!1,h=!1,o=null,d=null,_=new Map;const w=u=>{if(u.target.files.length==0)return;const g=u.target.files[0],F=new FileReader;F.readAsText(g),F.onload=U=>{var A;const j=(A=U.target)==null?void 0:A.result,N=JSON.parse(j);for(let z=0;z<N.length;z++)N[z].line_no=z+1;n(6,o={lines:N}),n(0,e=[...new Set(o.lines.map(z=>z.character))]),n(1,t=e[0]),E()}};function E(){async function u(){if(o!=null)for(;o.lines[s-1].character!=t;)n(2,s+=1),a||await new Promise(g=>setTimeout(g,1e3))}d=d||u().then(()=>{d=null})}function p(u){var N;if(console.log(u),!(u.inputType==="insertLineBreak"||u.inputType==="insertCompositionText"&&((N=u.data)==null?void 0:N.at(-1))==`
`)||o==null)return;u.preventDefault();const g=u.target.value,F=Ve.levenshtein(o.lines[s-1].line,g,A=>1,A=>1,(A,z)=>A==z?0:1),U=Je(F);_.set(s,U),n(7,_),n(2,s+=1);const j=u.target;j.value="",E()}function m(u,g){!h||g!=null&&g.key!="Enter"||(n(5,h=!1),n(3,r=u.line_no-5),n(2,s=u.line_no),n(7,_=new Map),E())}function v(u){n(7,_=new Map),E()}function k(u){h||(u.focus(),u.scrollIntoView(!1))}function c(){a=this.checked,n(4,a)}const y=()=>{n(5,h=!0)};function f(){t=De(this),n(1,t),n(0,e)}return[e,t,s,r,a,h,o,_,w,p,m,v,k,c,y,f,u=>{m(u)},(u,g)=>{m(u,g)}]}class Xe extends Pe{constructor(l){super(),Re(this,l,Ge,qe,Ae,{})}}export{Xe as default};
