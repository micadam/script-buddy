import{S as Te,i as Re,s as Ae,k as O,l as P,m as D,h as b,n as N,b as A,H as te,J as Se,q as B,a as L,r as C,c as q,K as De,G as z,L as fe,M as H,N as ne,O as re,u as J,e as X,P as je,p as K}from"../chunks/index.8b214ad8.js";var G={};G.Mapping=class{constructor(l,n,e,t,s){this.pairs=this.pairs.bind(this),this.alignment=this.alignment.bind(this),this.a=l,this.b=n,this.distance=e,this.track=t,this.backtrackFn=s,this.pairCache=null}pairs(){return this.pairCache==null&&(this.pairCache=this.backtrackFn(this.a,this.b,this.track)),this.pairCache}alignment(){var l,n,e,t,s,r,a;for(r=this.pairs(),l=[],n=[],a=r.reverse(),e=0,t=a.length;e<t;e++)s=a[e],l.push(s[0]),n.push(s[1]);return{alignmentA:l,alignmentB:n}}};G.zero=function(i,l){var n,e,t,s,r,a,h,o;for(h=new Array(i),n=t=0,r=i;t<r;n=t+=1)for(o=h[n]=new Array(l),e=s=0,a=l;s<a;e=s+=1)o[e]=0;return h};G.trackedMin=function(i,l,n){var e;return e={value:i,index:0},l<e.value&&(e.value=l,e.index=1),n<e.value&&(e.value=n,e.index=2),e};var we,Ee,ye,ze,Ie,W;({Mapping:we,zero:W,trackedMin:Ie}=G);Ee=function(i,l,n){var e,t,s,r,a,h,o,d,f,w,E;for(w=[],E=[],w.push([void 0,i]);w.length>0;)for([r,o]=w.pop(),t=l(o),s=(d=t!=null?t[0]:void 0)!=null?d:null,E.push([r,o,s]),f=t??[],r=a=0,h=f.length;a<h;r=++a)e=f[r],w.push([r,e]);for(;E.length>0;)[r,o,s]=E.pop(),n(r,o,s)};ye=function(i,l,n,e,t,s){var r,a,h,o,d,f,w,E,p,m,v,k,c,y,u,T;for(E=function(R){var _;return _={nodes:[],llds:[],keyroots:[]},Ee(R,n,function(g,F,U){var j,I,S;S=_.nodes.length,_.nodes.push(F),U==null?I=S:(j=_.nodes.indexOf(U),I=_.llds[j]),_.llds.push(I),g!==0&&_.keyroots.push(S)}),_},u=function(R,_){var g,F,U,j,I,S,M,V,Q,Y,Z,$,x,ee,ie,oe,le,ae,ce,he,ue;for(F=v.llds,I=k.llds,U=v.nodes,S=k.nodes,M=F[R]-1,V=I[_]-1,Z=R-F[R]+2,x=_-I[_]+2,g=Q=1,ae=Z;Q<ae;g=Q+=1)r[g][0]=r[g-1][0]+t(U[g+M]);for(j=Y=1,ce=x;Y<ce;j=Y+=1)r[0][j]=r[0][j-1]+e(S[j+V]);for(g=ee=1,he=Z;ee<he;g=ee+=1)for(j=le=1,ue=x;le<ue;j=le+=1)F[R]===F[g+M]&&I[_]===I[j+V]?($=Ie(r[g-1][j]+t(U[g+M]),r[g][j-1]+e(S[j+V]),r[g-1][j-1]+s(U[g+M],S[j+V])),T[g+M][j+V]=$.index,c[g+M][j+V]=r[g][j]=$.value):(ie=F[g+M]-1-M,oe=I[j+V]-1-V,r[g][j]=Math.min(r[g-1][j]+t(U[g+M]),r[g][j-1]+e(S[j+V]),r[ie][oe]+c[g+M][j+V]))},v=E(i),k=E(l),T=W(v.nodes.length,k.nodes.length),c=W(v.nodes.length,k.nodes.length),r=W(v.nodes.length+1,k.nodes.length+1),p=v.keyroots,o=0,f=p.length;o<f;o++)for(a=p[o],m=k.keyroots,d=0,w=m.length;d<w;d++)h=m[d],u(a,h);return y=c[v.nodes.length-1][k.nodes.length-1],new we(v,k,y,T,ze)};ze=function(i,l,n){var e,t,s;for(s=[],e=i.nodes.length-1,t=l.nodes.length-1;e>=0&&t>=0;)switch(n[e][t]){case 0:s.push([i.nodes[e],null]),--e;break;case 1:s.push([null,l.nodes[t]]),--t;break;case 2:s.push([i.nodes[e],l.nodes[t]]),--e,--t;break;default:throw new Error(`Invalid operation ${n[e][t]} at (${e}, ${t})`)}if(e===-1&&t!==-1)for(;t>=0;)s.push([null,l.nodes[t]]),--t;if(e!==-1&&t===-1)for(;e>=0;)s.push([i.nodes[e],null]),--e;return s};var Fe=ye,Me,Ne,Oe,Pe,se;({Mapping:Me,zero:se,trackedMin:Pe}=G);Ne=function(i,l,n,e,t){var s,r,a,h,o,d,f,w,E,p,m,v,k,c,y,u,T,R;for(s=i,a=l,R=se(s.length+1,a.length+1),o=se(s.length+1,a.length+1),f=E=1,c=s.length;E<=c;f=E+=1)o[f][0]=f;for(w=p=1,y=a.length;p<=y;w=p+=1)o[0][w]=w;for(f=m=1,u=s.length;m<=u;f=m+=1)for(w=k=1,T=a.length;k<=T;w=k+=1)r=s[f-1],h=a[w-1],v=Pe(o[f-1][w]+e(r),o[f][w-1]+n(h),o[f-1][w-1]+t(r,h)),R[f][w]=v.index,o[f][w]=v.value;return d=o[s.length][a.length],new Me(s,a,d,R,Oe)};Oe=function(i,l,n){var e,t,s;for(e=i.length,t=l.length,s=[];e>0&&t>0;)switch(n[e][t]){case 0:s.push([i[e-1],null]),--e;break;case 1:s.push([null,l[t-1]]),--t;break;case 2:s.push([i[e-1],l[t-1]]),--e,--t;break;default:throw new Error(`Invalid operation ${n[e][t]} at (${e}, ${t})`)}if(e===0&&t!==0)for(;t>0;)s.push([null,l[t-1]]),--t;if(e!==0&&t===0)for(;e>0;)s.push([i[e-1],null]),--e;return s};var Ue=Ne,Ve={ted:Fe,levenshtein:Ue};function _e(i,l,n){const e=i.slice();return e[20]=l[n],e}function pe(i,l,n){const e=i.slice();return e[23]=l[n],e}function de(i,l,n){const e=i.slice();return e[26]=l[n],e}function Be(i){let l,n,e,t,s,r,a,h,o,d,f,w,E=i[0],p=[];for(let c=0;c<E.length;c+=1)p[c]=ve(de(i,E,c));let m=i[6].lines,v=[];for(let c=0;c<m.length;c+=1)v[c]=me(_e(i,m,c));let k=i[6].lines[i[2]-1].character==i[1]&&be(i);return{c(){l=O("div"),n=O("input"),e=B(` Fast forward
			
			`),t=O("button"),s=B("Pick line"),r=L(),a=O("select");for(let c=0;c<p.length;c+=1)p[c].c();h=L(),o=O("div");for(let c=0;c<v.length;c+=1)v[c].c();d=L(),k&&k.c(),this.h()},l(c){l=P(c,"DIV",{id:!0});var y=D(l);n=P(y,"INPUT",{type:!0}),e=C(y,` Fast forward
			
			`),t=P(y,"BUTTON",{class:!0});var u=D(t);s=C(u,"Pick line"),u.forEach(b),r=q(y),a=P(y,"SELECT",{class:!0});var T=D(a);for(let _=0;_<p.length;_+=1)p[_].l(T);T.forEach(b),y.forEach(b),h=q(c),o=P(c,"DIV",{class:!0});var R=D(o);for(let _=0;_<v.length;_+=1)v[_].l(R);d=q(R),k&&k.l(R),R.forEach(b),this.h()},h(){N(n,"type","checkbox"),N(t,"class","svelte-vj1jsz"),N(a,"class","svelte-vj1jsz"),i[1]===void 0&&De(()=>i[15].call(a)),N(l,"id","controls"),N(o,"class","lines svelte-vj1jsz")},m(c,y){A(c,l,y),z(l,n),n.checked=i[4],z(l,e),z(l,t),z(t,s),z(l,r),z(l,a);for(let u=0;u<p.length;u+=1)p[u].m(a,null);fe(a,i[1]),A(c,h,y),A(c,o,y);for(let u=0;u<v.length;u+=1)v[u].m(o,null);z(o,d),k&&k.m(o,null),f||(w=[H(n,"change",i[13]),H(t,"click",i[14]),H(a,"change",i[15]),H(a,"change",i[11])],f=!0)},p(c,y){if(y&16&&(n.checked=c[4]),y&1){E=c[0];let u;for(u=0;u<E.length;u+=1){const T=de(c,E,u);p[u]?p[u].p(T,y):(p[u]=ve(T),p[u].c(),p[u].m(a,null))}for(;u<p.length;u+=1)p[u].d(1);p.length=E.length}if(y&3&&fe(a,c[1]),y&1262){m=c[6].lines;let u;for(u=0;u<m.length;u+=1){const T=_e(c,m,u);v[u]?v[u].p(T,y):(v[u]=me(T),v[u].c(),v[u].m(o,d))}for(;u<v.length;u+=1)v[u].d(1);v.length=m.length}c[6].lines[c[2]-1].character==c[1]?k?k.p(c,y):(k=be(c),k.c(),k.m(o,null)):k&&(k.d(1),k=null)},d(c){c&&b(l),ne(p,c),c&&b(h),c&&b(o),ne(v,c),k&&k.d(),f=!1,re(w)}}}function Ce(i){let l,n,e,t,s,r,a,h;return{c(){l=O("h1"),n=B("No script uploaded"),e=B(`
		Upload a script in .json format to get started.
		`),t=O("br"),s=L(),r=O("input"),this.h()},l(o){l=P(o,"H1",{class:!0});var d=D(l);n=C(d,"No script uploaded"),d.forEach(b),e=C(o,`
		Upload a script in .json format to get started.
		`),t=P(o,"BR",{}),s=q(o),r=P(o,"INPUT",{type:!0,accept:!0}),this.h()},h(){N(l,"class","svelte-vj1jsz"),N(r,"type","file"),N(r,"accept",".json")},m(o,d){A(o,l,d),z(l,n),A(o,e,d),A(o,t,d),A(o,s,d),A(o,r,d),a||(h=H(r,"change",i[8]),a=!0)},p:te,d(o){o&&b(l),o&&b(e),o&&b(t),o&&b(s),o&&b(r),a=!1,h()}}}function ve(i){let l,n=i[26]+"",e,t;return{c(){l=O("option"),e=B(n),this.h()},l(s){l=P(s,"OPTION",{});var r=D(l);e=C(r,n),r.forEach(b),this.h()},h(){l.__value=t=i[26],l.value=l.__value},m(s,r){A(s,l,r),z(l,e)},p(s,r){r&1&&n!==(n=s[26]+"")&&J(e,n),r&1&&t!==(t=s[26])&&(l.__value=t,l.value=l.__value)},d(s){s&&b(l)}}}function ge(i){let l,n,e=i[20].character+"",t,s,r,a,h;function o(p,m){return m&224&&(r=null),r==null&&(r=!!(!p[5]&&p[7].has(p[20].line_no))),r?Le:He}let d=o(i,-1),f=d(i);function w(){return i[16](i[20])}function E(...p){return i[17](i[20],...p)}return{c(){l=O("div"),n=O("h4"),t=B(e),s=L(),f.c(),this.h()},l(p){l=P(p,"DIV",{class:!0});var m=D(l);n=P(m,"H4",{class:!0});var v=D(n);t=C(v,e),v.forEach(b),s=q(m),f.l(m),m.forEach(b),this.h()},h(){N(n,"class","svelte-vj1jsz"),N(l,"class","line svelte-vj1jsz")},m(p,m){A(p,l,m),z(l,n),z(n,t),z(l,s),f.m(l,null),a||(h=[je(i[12].call(null,l)),H(l,"click",w),H(l,"keypress",E)],a=!0)},p(p,m){i=p,m&64&&e!==(e=i[20].character+"")&&J(t,e),d===(d=o(i,m))&&f?f.p(i,m):(f.d(1),f=d(i),f&&(f.c(),f.m(l,null)))},d(p){p&&b(l),f.d(),a=!1,re(h)}}}function He(i){let l=i[20].line+"",n;return{c(){n=B(l)},l(e){n=C(e,l)},m(e,t){A(e,n,t)},p(e,t){t&64&&l!==(l=e[20].line+"")&&J(n,l)},d(e){e&&b(n)}}}function Le(i){let l,n=i[7].get(i[20].line_no)||[{correct:"ERROR",color:"red"}],e=[];for(let t=0;t<n.length;t+=1)e[t]=ke(pe(i,n,t));return{c(){for(let t=0;t<e.length;t+=1)e[t].c();l=X()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);l=X()},m(t,s){for(let r=0;r<e.length;r+=1)e[r].m(t,s);A(t,l,s)},p(t,s){if(s&192){n=t[7].get(t[20].line_no)||[{correct:"ERROR",color:"red"}];let r;for(r=0;r<n.length;r+=1){const a=pe(t,n,r);e[r]?e[r].p(a,s):(e[r]=ke(a),e[r].c(),e[r].m(l.parentNode,l))}for(;r<e.length;r+=1)e[r].d(1);e.length=n.length}},d(t){ne(e,t),t&&b(l)}}}function ke(i){let l,n=i[23].correct+"",e,t,s=i[23].incorrect+"",r;return{c(){l=O("span"),e=B(n),t=O("span"),r=B(s),this.h()},l(a){l=P(a,"SPAN",{style:!0,class:!0});var h=D(l);e=C(h,n),t=P(h,"SPAN",{style:!0,class:!0});var o=D(t);r=C(o,s),o.forEach(b),h.forEach(b),this.h()},h(){K(t,"text-decoration","line-through"),K(t,"font-size","8pt"),N(t,"class","svelte-vj1jsz"),K(l,"color",i[23].color),N(l,"class","svelte-vj1jsz")},m(a,h){A(a,l,h),z(l,e),z(l,t),z(t,r)},p(a,h){h&192&&n!==(n=a[23].correct+"")&&J(e,n),h&192&&s!==(s=a[23].incorrect+"")&&J(r,s),h&192&&K(l,"color",a[23].color)},d(a){a&&b(l)}}}function me(i){let l,n=(i[5]||i[20].line_no>=i[3]&&i[20].line_no<=i[2]&&!(i[20].line_no==i[2]&&i[20].character==i[1]))&&ge(i);return{c(){n&&n.c(),l=X()},l(e){n&&n.l(e),l=X()},m(e,t){n&&n.m(e,t),A(e,l,t)},p(e,t){e[5]||e[20].line_no>=e[3]&&e[20].line_no<=e[2]&&!(e[20].line_no==e[2]&&e[20].character==e[1])?n?n.p(e,t):(n=ge(e),n.c(),n.m(l.parentNode,l)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&b(l)}}}function be(i){let l,n,e,t,s,r,a;return{c(){l=O("div"),n=O("h4"),e=B(i[1]),t=L(),s=O("textarea"),this.h()},l(h){l=P(h,"DIV",{class:!0});var o=D(l);n=P(o,"H4",{class:!0});var d=D(n);e=C(d,i[1]),d.forEach(b),t=q(o),s=P(o,"TEXTAREA",{id:!0,class:!0}),D(s).forEach(b),o.forEach(b),this.h()},h(){N(n,"class","svelte-vj1jsz"),N(s,"id","user_input"),N(s,"class","svelte-vj1jsz"),N(l,"class","line svelte-vj1jsz")},m(h,o){A(h,l,o),z(l,n),z(n,e),z(l,t),z(l,s),r||(a=[H(s,"keypress",i[9]),H(s,"input",Je),je(i[12].call(null,s))],r=!0)},p(h,o){o&2&&J(e,h[1])},d(h){h&&b(l),r=!1,re(a)}}}function qe(i){let l;function n(s,r){return s[6]==null?Ce:Be}let e=n(i),t=e(i);return{c(){l=O("div"),t.c(),this.h()},l(s){l=P(s,"DIV",{id:!0,class:!0});var r=D(l);t.l(r),r.forEach(b),this.h()},h(){N(l,"id","container"),N(l,"class","svelte-vj1jsz")},m(s,r){A(s,l,r),t.m(l,null)},p(s,[r]){e===(e=n(s))&&t?t.p(s,r):(t.d(1),t=e(s),t&&(t.c(),t.m(l,null)))},i:te,o:te,d(s){s&&b(l),t.d()}}}function Je(i){console.log(i)}function Ge(i){let l="",n="",e="";const t=[];for(const s of i.pairs().reverse()){const[r,a]=s,h=r===a?"green":"red";h!=l&&(n!=""||e!="")&&(t.push({correct:n,incorrect:e,color:l}),n="",e=""),l=h,r!=null&&(n+=r),a!=null&&r!=a&&(e+=a)}return(n!=""||e!="")&&t.push({correct:n,incorrect:e,color:l}),t}function Ke(i,l,n){let e=[],t="",s=1,r=1,a=!1,h=!1,o=null,d=null,f=new Map;const w=_=>{if(_.target.files.length==0)return;const g=_.target.files[0],F=new FileReader;F.readAsText(g),F.onload=U=>{var S;const j=(S=U.target)==null?void 0:S.result,I=JSON.parse(j);for(let M=0;M<I.length;M++)I[M].line_no=M+1;n(6,o={lines:I}),n(0,e=[...new Set(o.lines.map(M=>M.character))]),n(1,t=e[0]),E()}};function E(){async function _(){if(o!=null)for(;o.lines[s-1].character!=t;)n(2,s+=1),a||await new Promise(g=>setTimeout(g,1e3))}d=d||_().then(()=>{d=null})}function p(_){if(_.key!="Enter"||o==null)return;const g=_.target.value,F=Ve.levenshtein(o.lines[s-1].line,g,I=>1,I=>1,(I,S)=>I==S?0:1),U=Ge(F);f.set(s,U),n(7,f),n(2,s+=1);const j=_.target;j.value="",E()}function m(_,g){!h||g!=null&&g.key!="Enter"||(n(5,h=!1),n(3,r=_.line_no-5),n(2,s=_.line_no),n(7,f=new Map),E())}function v(_){n(7,f=new Map),E()}function k(_){h||(_.focus(),_.scrollIntoView(!1))}function c(){a=this.checked,n(4,a)}const y=()=>{n(5,h=!0)};function u(){t=Se(this),n(1,t),n(0,e)}return[e,t,s,r,a,h,o,f,w,p,m,v,k,c,y,u,_=>{m(_)},(_,g)=>{m(_,g)}]}class Qe extends Te{constructor(l){super(),Re(this,l,Ke,qe,Ae,{})}}export{Qe as default};
